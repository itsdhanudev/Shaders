{"code":"#version 320 es\nprecision highp float;\n\nlayout(triangles) in;\nlayout(triangle_strip, max_vertices \u003d 12) out;\n\nin vec3 o_pos[];\nin vec3 o_normal[];\n\nout vec3 f_normal;\nout float f_height;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\nuniform float u_grassHeight;\nuniform float u_grassWidth;\nuniform float u_time;\nuniform float u_windStrength;\nuniform float u_windSpeed;\n\nfloat hash(vec3 p) {\n    return fract(sin(dot(p, vec3(12.9898,78.233,45.164))) * 43758.5453);\n}\n\nvoid emitBlade(vec3 basePos, vec3 normal) {\n\n    float h \u003d u_grassHeight * (0.6 + hash(basePos));\n    float w \u003d u_grassWidth;\n\n    vec3 wind \u003d\n        vec3(\n            sin(u_time * u_windSpeed + basePos.x),\n            0.0,\n            cos(u_time * u_windSpeed + basePos.z)\n        ) * u_windStrength;\n\n    vec3 tip \u003d basePos + normal * h + wind;\n\n    vec3 right \u003d normalize(cross(normal, vec3(0,1,0))) * w;\n\n    // base left\n    gl_Position \u003d projectionMatrix * viewMatrix * vec4(basePos - right, 1.0);\n    f_height \u003d 0.0;\n    EmitVertex();\n\n    // base right\n    gl_Position \u003d projectionMatrix * viewMatrix * vec4(basePos + right, 1.0);\n    f_height \u003d 0.0;\n    EmitVertex();\n\n    // tip\n    gl_Position \u003d projectionMatrix * viewMatrix * vec4(tip, 1.0);\n    f_height \u003d 1.0;\n    EmitVertex();\n\n    EndPrimitive();\n}\n\nvoid main() {\n    for (int i \u003d 0; i \u003c 3; i++) {\n        emitBlade(o_pos[i], o_normal[i]);\n    }\n}\n"}